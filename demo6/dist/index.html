<!DOCTYPE html>
<html lang="en">
   <!--begin::Head-->
   <head>
      <base href="">
      <meta charset="utf-8" />
      <title>Sachait - Elecbits Dashboard</title>
      <meta name="description" content="Updates and statistics" />
      <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
      <!--begin::Fonts-->
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700" />
      <!--end::Fonts-->
      <!--begin::Page Vendors Styles(used by this page)-->
      <link href="assets/plugins/custom/fullcalendar/fullcalendar.bundle.css" rel="stylesheet" type="text/css" />
      <!--end::Page Vendors Styles-->
      <!--begin::Global Theme Styles(used by all pages)-->
      <link href="assets/plugins/global/plugins.bundle.css" rel="stylesheet" type="text/css" />
      <link href="assets/plugins/custom/prismjs/prismjs.bundle.css" rel="stylesheet" type="text/css" />
      <link href="assets/css/style.bundle.css" rel="stylesheet" type="text/css" />
      <!--end::Global Theme Styles-->
      <!--begin::Layout Themes(used by all pages)-->
      <!--end::Layout Themes-->
      <link rel="shortcut icon" href="assets/media/logo2.png" />
      <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular.min.js"></script>
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
      <style type="text/css">
         .symbol.symbol-light-primary .symbol-label {
          background-color: #ffffff;
         color: #8950FC;
         }

        /* .width50 {
            width: 50%
         }*/
      </style>
   </head>
   <!--end::Head-->
   <!--begin::Body-->
   <body id="kt_body" class="header-fixed header-mobile-fixed sidebar-enabled page-loading" ng-app="myApp" ng-controller="myCtrl">
      <!--begin::Main-->
      <!--begin::Header Mobile-->
      <div id="kt_header_mobile" class="header-mobile header-mobile-fixed">
         <!--begin::Logo-->
         <a href="index.html">
         <img alt="Logo" src="assets/media/logo2.png" class="logo-default max-h-30px" />
         </a>
         <!--end::Logo-->
         <!--begin::Toolbar-->
         <!--end::Toolbar-->
      </div>
      <!--end::Header Mobile-->
      <div class="d-flex flex-column flex-root">
         <!--begin::Page-->
         <div class="d-flex flex-row flex-column-fluid page">
            <!--begin::Aside-->
            <div class="aside aside-left d-flex flex-column" id="kt_aside">
               <!--begin::Brand-->
               <div class="aside-brand d-flex flex-column align-items-center flex-column-auto pb-10">
                  <!--begin::Logo-->
                  <div class="btn p-0 symbol symbol-100 symbol-light-primary" id="kt_quick_user_toggle">
                     <div class="symbol-label">
                        <img alt="Logo" src="assets/media/logo2.png" class="h-75 align-self-end" />
                     </div>
                  </div>
                  <!--end::Logo-->
               </div>
               <!--end::Brand-->
               <!--begin::Nav Wrapper-->
               <!--end::Nav Wrapper-->
               <!--begin::Footer-->
               <div class="aside-footer d-flex flex-column align-items-center flex-column-auto py-8">
                  <!--begin::Notifications-->
                  <!--end::Notifications-->
                  <!--begin::Quick Actions-->
                  <a href="history.html" class="btn btn-icon btn-hover-text-primary btn-lg mb-1" id="kt_quick_actions_toggle" data-toggle="tooltip" data-placement="right" data-container="body" data-boundary="window" title="History">
                  <span class="svg-icon svg-icon-primary svg-icon-2x"><!--begin::Svg Icon | path:C:\wamp64\www\keenthemes\themes\metronic\theme\html\demo6\dist/../src/media/svg/icons\Code\Time-schedule.svg--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1">
                     <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                         <rect x="0" y="0" width="24" height="24"/>
                        <path d="M10.9630156,7.5 L11.0475062,7.5 C11.3043819,7.5 11.5194647,7.69464724 11.5450248,7.95024814 L12,12.5 L15.2480695,14.3560397 C15.403857,14.4450611 15.5,14.6107328 15.5,14.7901613 L15.5,15 C15.5,15.2109164 15.3290185,15.3818979 15.1181021,15.3818979 C15.0841582,15.3818979 15.0503659,15.3773725 15.0176181,15.3684413 L10.3986612,14.1087258 C10.1672824,14.0456225 10.0132986,13.8271186 10.0316926,13.5879956 L10.4644883,7.96165175 C10.4845267,7.70115317 10.7017474,7.5 10.9630156,7.5 Z" fill="#000000"/>
                        <path d="M7.38979581,2.8349582 C8.65216735,2.29743306 10.0413491,2 11.5,2 C17.2989899,2 22,6.70101013 22,12.5 C22,18.2989899 17.2989899,23 11.5,23 C5.70101013,23 1,18.2989899 1,12.5 C1,11.5151324 1.13559454,10.5619345 1.38913364,9.65805651 L3.31481075,10.1982117 C3.10672013,10.940064 3,11.7119264 3,12.5 C3,17.1944204 6.80557963,21 11.5,21 C16.1944204,21 20,17.1944204 20,12.5 C20,7.80557963 16.1944204,4 11.5,4 C10.54876,4 9.62236069,4.15592757 8.74872191,4.45446326 L9.93948308,5.87355717 C10.0088058,5.95617272 10.0495583,6.05898805 10.05566,6.16666224 C10.0712834,6.4423623 9.86044965,6.67852665 9.5847496,6.69415008 L4.71777931,6.96995273 C4.66931162,6.97269931 4.62070229,6.96837279 4.57348157,6.95710938 C4.30487471,6.89303938 4.13906482,6.62335149 4.20313482,6.35474463 L5.33163823,1.62361064 C5.35654118,1.51920756 5.41437908,1.4255891 5.49660017,1.35659741 C5.7081375,1.17909652 6.0235153,1.2066885 6.2010162,1.41822583 L7.38979581,2.8349582 Z" fill="#000000" opacity="0.3"/>
                      </g>
                  </svg><!--end::Svg Icon-->
               </span>
                  </a>
                  <!--end::Quick Actions-->
                  <!--begin::Quick Panel-->
                  <!--end::Quick Panel-->
                  <!--begin::Languages-->
                  <!--end::Languages-->
               </div>
               <!--end::Footer-->
            </div>
            <!--end::Aside-->
            <!--begin::Wrapper-->
            <div class="d-flex flex-column flex-row-fluid wrapper" id="kt_wrapper">
               <!--begin::Header-->
               <div id="kt_header" class="header header-fixed">
                  <!--begin::Header Wrapper-->
                  <div class="header-wrapper rounded-top-xl d-flex flex-grow-1 align-items-center">
                     <!--begin::Container-->
                     <div class="container-fluid d-flex align-items-center justify-content-end justify-content-lg-between flex-wrap">
                        <!--begin::Menu Wrapper-->
                        <div class="header-menu-wrapper header-menu-wrapper-left py-lg-2" id="kt_header_menu_wrapper">
                           <!--begin::Menu-->
                           <div id="kt_header_menu" class="header-menu header-menu-mobile header-menu-layout-default">
                              <!--begin::Nav-->
                              <ul class="menu-nav">
                                 <li class="menu-item menu-item-active" aria-haspopup="true">
                                    <a href="index.html" class="menu-link">
                                    <span class="menu-text">Escalated</span>
                                    </a>
                                 </li>
                                 <li class="menu-item" aria-haspopup="true">
                                    <!--<a href="escalated.html" class="menu-link">
                                       <span class="menu-text">Escalated</span>
                                       </a> -->
                                 </li>
                              </ul>
                              <!--end::Nav-->
                           </div>
                           <!--end::Menu-->
                        </div>
                        <!--end::Menu Wrapper-->
                        <!--begin::Toolbar-->
                        <div class="d-flex align-items-center py-3">
                           <!--begin::Dropdown-->
                           <!--end::Dropdown-->
                        </div>
                        <!--end::Toolbar-->
                     </div>
                     <!--end::Container-->
                  </div>
                  <!--end::Header Wrapper-->
               </div>
               <!--end::Header-->
               <!--begin::Content-->
               <div class="content d-flex flex-column flex-column-fluid" id="kt_content">
                  <!--begin::Entry-->
                  <div class="d-flex flex-column-fluid">
                     <!--begin::Container-->
                     <div class="container">
                        <!--begin::Dashboard-->
                        
                        <!--begin::Advance Table Widget 4-->
                        <div class="card card-custom card-shadowless gutter-b">
                           <!--begin::Header-->
                           <div class="card-header border-0 py-5">
                              <h3 class="card-title align-items-start flex-column">
                                 <span class="card-label font-weight-bolder text-dark">Escalated Notifications</span>
                              </h3>
                           </div>
                           <!--end::Header-->
                           <!--begin::Body-->
                           <div class="card-body pt-0 pb-3">
                              <div class="tab-content">
                                 <!--begin::Table-->
                                 <div class="table-responsive">
                                    <table class="table table-head-custom table-vertical-center" id="kt_advance_table_widget_1">
                                       <thead>
                                          <tr class="text-left text-uppercase">
                                             <th style="min-width: 130px">
                                                <span class="text-dark-75">Time</span>
                                             </th>
                                             <th style="min-width: 250px">Details</th>
                                             <th style="min-width: 150px">Live Information</th>
                                          </tr>
                                       </thead>
                                       <tbody>
                                          <tr ng-repeat="notif in notifications">
                                             <td  class="pr-0 text-left">
                                                <div class="d-flex align-items-center">
                                                   <div><a class="text-dark-75 font-weight-bolder d-block font-size-lg">{{timestampToDate(notif.escalationTimestamp)}}</a></div>
                                                </div>
                                             </td>

                                             <td>
                                                <span class="text-muted font-weight-bold">Notification Id - {{notif.notificationId}}</span>
                                                <br><br>
                                                <span class="text-dark-75 font-weight-bolder d-block font-size-lg">Name - {{notif.victimName}}</span>
                                                <span class="text-dark-75 font-weight-bolder d-block font-size-lg">Mobile Number - {{notif.victimPhone}}</span>
                                                <span class="text-dark-75 font-weight-bolder d-block font-size-lg">Escalated By {{notif.escalatedByName}} - {{notif.escalatedByPhone}}</span>
                                                <br>
                                                <div class="width50"><span class="text-muted font-weight-bold">First Responders - {{notif.victimFirstResponderList}}</span></div><br>
                                                <button type="button" ng-click="takeAction(notif.notificationId, notif.escalationTimestamp)" class="btn btn-outline-danger">Take Action</button>
                                             </td>

                                             <td class="pr-0 text-left"><br><br>
                                                <a ng-if="notif.incidentSource == 'device' && sirenStatus == 'OFF'" class="btn btn-danger" ng-click="playSirenFunction(notif.notificationId, 'ON')">
                                                   <i class="flaticon2-bell-alarm-symbol"></i> Play Siren
                                                </a>
                                                <a ng-if="notif.incidentSource == 'device' && sirenStatus == 'ON'" class="btn btn-danger" ng-click="playSirenFunction(notif.notificationId, 'OFF')">
                                                   <i class="flaticon2-bell-alarm-symbol"></i> Stop Siren
                                                </a> <br><br>
                                                <a class="btn btn-primary"  ng-click="openLiveFeedModal(notif)" >
                                                   <i class="flaticon-eye"></i>Live Preview
                                                </a><br><br>
                                                <a class="btn btn-success" ng-click="openLocationModal(notif)">
                                                   <i class="flaticon2-pin-1"></i>Live Location
                                                </a>
                                                <br><br><br><br>
                                             </td>
                                          </tr>
                                       </tbody>
                                    </table>
                                 </div>
                                 <!--end::Table-->
                              </div>
                           </div>
                           <!--end::Body-->
                        </div>
                        <!--end::Advance Table Widget 4-->
                        <!--end::Dashboard-->
                     </div>
                     <!--end::Container-->
                  </div>
                  <!--end::Entry-->
               </div>
               <!--end::Content-->
               <!--begin::Footer-->
               <!--end::Footer-->
            </div>
            <!--end::Wrapper-->
            <!--begin::Aside Secondary-->
            <div class="sidebar sidebar-left d-flex flex-row-auto flex-column" id="kt_sidebar">
               <!--begin::Aside Secondary Header-->
               <div class="sidebar-header flex-column-auto pt-5 pt-lg-19 pb-5 px-5 px-lg-10">
                  <!--begin::Toolbar-->
                  <div class="d-flex">
                     <!--begin::Desktop Search-->
                     <div class="quick-search quick-search-inline flex-grow-1" id="kt_quick_search_inline">
                        <!--begin::Form-->
                        <form method="get" class="quick-search-form">
                           <div class="input-group rounded bg-light">
                              <div class="input-group-prepend">
                                 <span class="input-group-text">
                                    <span class="svg-icon svg-icon-lg">
                                       <!--begin::Svg Icon | path:assets/media/svg/icons/General/Search.svg-->
                                       <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1">
                                          <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                             <rect x="0" y="0" width="24" height="24" />
                                             <path d="M14.2928932,16.7071068 C13.9023689,16.3165825 13.9023689,15.6834175 14.2928932,15.2928932 C14.6834175,14.9023689 15.3165825,14.9023689 15.7071068,15.2928932 L19.7071068,19.2928932 C20.0976311,19.6834175 20.0976311,20.3165825 19.7071068,20.7071068 C19.3165825,21.0976311 18.6834175,21.0976311 18.2928932,20.7071068 L14.2928932,16.7071068 Z" fill="#000000" fill-rule="nonzero" opacity="0.3" />
                                             <path d="M11,16 C13.7614237,16 16,13.7614237 16,11 C16,8.23857625 13.7614237,6 11,6 C8.23857625,6 6,8.23857625 6,11 C6,13.7614237 8.23857625,16 11,16 Z M11,18 C7.13400675,18 4,14.8659932 4,11 C4,7.13400675 7.13400675,4 11,4 C14.8659932,4 18,7.13400675 18,11 C18,14.8659932 14.8659932,18 11,18 Z" fill="#000000" fill-rule="nonzero" />
                                          </g>
                                       </svg>
                                       <!--end::Svg Icon-->
                                    </span>
                                 </span>
                              </div>
                              <input type="text" class="form-control h-40px" placeholder="Search..." />
                              <div class="input-group-append">
                                 <span class="input-group-text">
                                 <i class="quick-search-close ki ki-close icon-sm text-muted"></i>
                                 </span>
                              </div>
                           </div>
                        </form>
                        <!--end::Form-->
                        <!--begin::Search Toggle-->
                        <div id="kt_quick_search_toggle" data-toggle="dropdown" data-offset="0px,1px"></div>
                        <!--end::Search Toggle-->
                        <!--begin::Dropdown-->
                        <div class="dropdown-menu dropdown-menu-right dropdown-menu-lg dropdown-menu-anim-up">
                           <div class="quick-search-wrapper scroll" data-scroll="true" data-height="350" data-mobile-height="200"></div>
                        </div>
                        <!--end::Dropdown-->
                     </div>
                     <!--end::Desktop Search-->
                     <!--begin::Dropdown-->
                     <!--end::Dropdown-->
                     <!--begin::Dropdown-->
                     <!--end::Dropdown-->
                  </div>
                  <!--end::Toolbar-->
               </div>
               <!--end::Aside Secondary Header-->
               <!--begin::Aside Secondary Content-->
               <div class="sidebar-content flex-column-fluid pb-10 pt-9 px-5 px-lg-10">
                  <!--begin: Stats Widget 19-->
                  <div class="card card-custom bg-light-primary card-shadowless gutter-b">
                     <!--begin::Body-->
                     <div class="card-body my-3">
                        <a href="#" class="card-title font-weight-bolder text-primary text-hover-state-dark font-size-h6 mb-4 d-block">Action Taken Notifications</a>
                        <div class="font-weight-bold text-muted font-size-sm">
                           <span class="text-dark-75 font-size-h2 font-weight-bolder mr-2">{{stats.actionTaken}} ({{actionTakenPercent}}%)</span>
                        </div>
                        <div class="progress progress-xs mt-7 bg-primary-o-60">
                           <div class="progress-bar bg-primary" role="progressbar" style="width: {{actionTakenPercent}}%;" aria-valuenow="{{stats.actionTaken}}" aria-valuemin="0" aria-valuemax="{{stats.totalNotificationCount}}"></div>
                        </div>
                     </div>
                     <!--end:: Body-->
                  </div>
                  <!--end: Stats:Widget 19-->
                  <!--begin::Stats Widget 20-->
                  <div class="card card-custom bg-light-danger card-shadowless gutter-b">
                     <!--begin::Body-->
                     <div class="card-body my-4">
                        <a href="#" class="card-title font-weight-bolder text-danger font-size-h6 mb-4 text-hover-state-dark d-block">No Action Taken Notifications</a>
                        <div class="font-weight-bold text-muted font-size-sm">
                           <span class="text-dark-75 font-weight-bolder font-size-h2 mr-2">{{stats.noActionTaken}} ({{noActionTakenPercent}}%)</span>
                        </div>
                        <div class="progress progress-xs mt-7 bg-danger-o-60">
                           <div class="progress-bar bg-danger" role="progressbar" style="width: {{noActionTakenPercent}}%;" aria-valuenow="{{stats.deviceCount}}" aria-valuemin="0" aria-valuemax="{{devicePercent}}"></div>
                        </div>
                     </div>
                     <!--end::Body-->
                  </div>
                  <!--end::Stats Widget 20-->

<!--                   <div class="card card-custom bg-light-success card-shadowless gutter-b">
                     <div class="card-body my-4">
                        <a href="#" class="card-title font-weight-bolder text-success font-size-h6 mb-4 text-hover-state-dark d-block">Total Notifications</a>
                        <div class="font-weight-bold text-muted font-size-sm">
                           <span class="text-dark-75 font-weight-bolder font-size-h2 mr-2">{{stats.totalNotificationCount}}</span>
                        </div>
                        <div class="progress progress-xs mt-7 bg-danger-o-60">
                           <div class="progress-bar bg-success" role="progressbar" style="width: 100%;" aria-valuenow="{{stats.deviceCount}}" aria-valuemin="0" aria-valuemax="{{devicePercent}}"></div>
                        </div>
                     </div>
                  </div> -->

                  <!--begin::List Widget 4-->
                  
                  <!--end::List Widget 1-->
               </div>
               <!--end::Aside Secondary Content-->
            </div>
            <!--end::Aside Secondary-->
         </div>
         <!--end::Page-->
      </div>
      <!--end::Main-->

      <!-- LIVE FEED MODAL -->
      <div class="modal fade" id="liveFeedModal" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
         <div class="modal-dialog modal-xl"  role="document">
            <div class="modal-content" style="text-align: center;">
               <div class="modal-header">
                  <h5 class="modal-title" id="exampleModalLabel">Live Preview</h5>
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close"><i aria-hidden="true" class="ki ki-close"></i></button>
               </div>
               <div class="modal-body">
                  <div class="col-lg-12"  style="height:450px; " ><iframe style="border: none" src="{{liveFeedUrl}}" allowfullscreen height="100%" width="100%"></iframe>
                  </div>
               </div>
            </div>
         </div>
      </div>

      <!-- LOCATION MODAL -->
      <div class="modal fade" id="locationModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel1" aria-hidden="true">
         <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
               <div class="modal-header">
                  <h5 class="modal-title" id="exampleModalLabel1">Live Location</h5>
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close"><i aria-hidden="true" class="ki ki-close"></i></button>
               </div>
               <div class="modal-body">
                  <div class="col-lg-12" style="padding: 20px 0px 20px 20px;" >
                     <div class="mapouter">
                        <div class="gmap_canvas"><iframe width="700" height="500" id="gmap_canvas" ng-src="{{locationUrl}}" frameborder="0" scrolling="no" marginheight="0" marginwidth="0"></iframe></div>
                        <style>.mapouter{position:relative;text-align:right;height:500px;width:700px;}.gmap_canvas {overflow:hidden;background:none!important;height:500px;width:700px;}</style>
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </div>
      <!--end::Demo Panel-->
      <script src="https://vjs.zencdn.net/7.5.5/video.js"></script>
      <script>var HOST_URL = "https://keenthemes.com/metronic/tools/preview";</script>
      <!--begin::Global Config(global config for global JS scripts)-->
      <script>var KTAppSettings = { "breakpoints": { "sm": 576, "md": 768, "lg": 992, "xl": 1200, "xxl": 1200 }, "colors": { "theme": { "base": { "white": "#ffffff", "primary": "#8950FC", "secondary": "#E5EAEE", "success": "#1BC5BD", "info": "#8950FC", "warning": "#FFA800", "danger": "#F64E60", "light": "#F3F6F9", "dark": "#212121" }, "light": { "white": "#ffffff", "primary": "#E1E9FF", "secondary": "#ECF0F3", "success": "#C9F7F5", "info": "#EEE5FF", "warning": "#FFF4DE", "danger": "#FFE2E5", "light": "#F3F6F9", "dark": "#D6D6E0" }, "inverse": { "white": "#ffffff", "primary": "#ffffff", "secondary": "#212121", "success": "#ffffff", "info": "#ffffff", "warning": "#ffffff", "danger": "#ffffff", "light": "#464E5F", "dark": "#ffffff" } }, "gray": { "gray-100": "#F3F6F9", "gray-200": "#ECF0F3", "gray-300": "#E5EAEE", "gray-400": "#D6D6E0", "gray-500": "#B5B5C3", "gray-600": "#80808F", "gray-700": "#464E5F", "gray-800": "#1B283F", "gray-900": "#212121" } }, "font-family": "Poppins" };</script>
      <!--end::Global Config-->
      <!--begin::Global Theme Bundle(used by all pages)-->
      <script src="assets/plugins/global/plugins.bundle.js"></script>
      <script src="assets/plugins/custom/prismjs/prismjs.bundle.js"></script>
      <script src="assets/js/scripts.bundle.js"></script>
      <!--end::Global Theme Bundle-->
      <!--begin::Page Vendors(used by this page)-->
      <script src="assets/plugins/custom/fullcalendar/fullcalendar.bundle.js"></script>
      <!--end::Page Vendors-->
      <!--begin::Page Scripts(used by this page)-->
      <script src="assets/js/pages/widgets.js"></script>
   </body>
   <script src="js/aws-iot-sdk-browser-bundle.js"></script>
   <script src="js/bundle.js"></script>
   <!--end::Body-->
</html>